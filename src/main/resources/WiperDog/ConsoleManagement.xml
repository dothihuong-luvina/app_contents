<?xml version="1.0" encoding="UTF-8"?>
<xwikidoc>
<web>WiperDog</web>
<name>ConsoleManagement</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent>Main.SpaceIndex</parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1377155775000</creationDate>
<date>1377697220000</date>
<contentUpdateDate>1377697220000</contentUpdateDate>
<version>29.1</version>
<title>ConsoleManagement</title>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment>Imported from XAR</comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/2.1</syntaxId>
<hidden>false</hidden>
<object>
<class>
<name>XWiki.JavaScriptExtension</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<cache>
<cache>0</cache>
<disabled>0</disabled>
<displayType>select</displayType>
<multiSelect>0</multiSelect>
<name>cache</name>
<number>5</number>
<prettyName>Caching policy</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>1</size>
<unmodifiable>0</unmodifiable>
<values>long|short|default|forbid</values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</cache>
<code>
<disabled>0</disabled>
<name>code</name>
<number>2</number>
<prettyName>Code</prettyName>
<rows>20</rows>
<size>50</size>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
</code>
<name>
<disabled>0</disabled>
<name>name</name>
<number>1</number>
<prettyName>Name</prettyName>
<size>30</size>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
</name>
<parse>
<disabled>0</disabled>
<displayFormType>select</displayFormType>
<displayType>yesno</displayType>
<name>parse</name>
<number>4</number>
<prettyName>Parse content</prettyName>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
</parse>
<use>
<cache>0</cache>
<disabled>0</disabled>
<displayType>select</displayType>
<multiSelect>0</multiSelect>
<name>use</name>
<number>3</number>
<prettyName>Use this extension</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>1</size>
<unmodifiable>0</unmodifiable>
<values>currentPage=Always on this page|onDemand=On demand|always=Always on this wiki</values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</use>
</class>
<name>WiperDog.ConsoleManagement</name>
<number>0</number>
<className>XWiki.JavaScriptExtension</className>
<guid>075acb8d-edba-4ae2-90ac-d0af2b105ed5</guid>
<property>
<cache>default</cache>
</property>
<property>
<code>require(['jquery'],function($){
    $("#btnStart").click(function(){    		
    		console.log('Starting Wiperdog monitoring agent...');
    		$("#consoleout").text('Starting Wiperdog monitoring agent...');
   		var commandURL = '/xwiki/bin/get/Lib/ConsoleService?outputSyntax=plain&amp;cmd=start';
   		console.log('commandURL = ' + commandURL);   			
   		execute(commandURL);
 	});
 	$("#btnStop").click(function(){
    	        $("#consoleout").text('Stoping Wiperdog monitoring agent...');
   		var commandURL = '/xwiki/bin/get/Lib/ConsoleService?outputSyntax=plain&amp;cmd=stop';
   		console.log('commandURL = ' + commandURL);   			
   		execute(commandURL);
 	});
 	$("#btnStatus").click(function(){
    	        $("#consoleout").text('Query status of Wiperdog.');
   		var commandURL = '/xwiki/bin/get/Lib/ConsoleService?outputSyntax=plain&amp;cmd=status';
   		console.log('commandURL = ' + commandURL);   			
   		execute(commandURL);
 	});
 	$("#btnHostInfo").click(function(){
    	$("#consoleout").text('Query host information...');
   		var commandURL = '/xwiki/bin/get/Lib/ConsoleService?outputSyntax=plain&amp;cmd=hostinfo';
   		console.log('commandURL = ' + commandURL);   			
   		executeJson(commandURL);
 	});
 	function execute(commandURL){
 		var jqxhr = $.get(commandURL, function(data) {
   			console.log('Complete executing command');
			$("#consoleout").html(data.toString());
		});	
 	}
 	function executeJson(commandURL){
 		$("#txtHostName").val('');
		$("#txtHostIP").val('');
		$("#txtPort").val('');
 		var jqxhr = $.getJSON(commandURL, function(data) {
   			console.log('Data hostName' + data.hostName);
   			console.log('Data hostIp' + data.hostIp);
   			console.log('Data hostPort' + data.hostPort);
   			$("#txtHostName").val(data.hostName);
   			$("#txtHostIP").val(data.hostIp);
   			$("#txtPort").val(data.hostPort);
   			$("#consoleout").text('Query host information...DONE!');
		});	
 	}

});</code>
</property>
<property>
<name>ConsoleMgmtJS</name>
</property>
<property>
<parse>0</parse>
</property>
<property>
<use>currentPage</use>
</property>
</object>
<content>{{velocity}}
$xwiki.jsx.use('Lib.JQueryUILib')
$xwiki.ssx.use('Lib.JQueryUILib')
{{/velocity}}
{{tabs idsToLabels='tabId11=General, tabId12=System components' /}}

(%id="tabId11"%)
(((
{{html wiki="true" clean="false"}}
&lt;h4&gt;Wiperdog system control panel&lt;/h4&gt;
&lt;input type="hidden" id="cmd_str" name="cmd_str"/&gt;
&lt;table cellpadding="0" cellspacing="0" border="0" style="width:98%"&gt;
	&lt;tr&gt;
		&lt;td colspan="2" align="center"&gt;
			&lt;input id="btnStart" name="btnStart" style="align: middle" type="button" value="Start" class="button"/&gt;
			&lt;input id="btnStop" name="btnStop" style="align:middle" type="button" value="Stop" class="button"/&gt;
			&lt;input id="btnStatus" name="btnStatus" style="align:midle" type="button" value="Status" class="button"/&gt;
		&lt;/td&gt;
		&lt;td&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td colspan="2" align="center"&gt;
{{/html}}
{{groovy}}
	println "{{html wiki=\"true\" clean=\"false\"}}"
	println "&lt;img src=\"/xwiki/resources/consolemgmt/wp-u.png\" title=\"Wiperdog Server Status\"/&gt;"
	println "{{/html}}"
{{/groovy}}
{{html wiki="true" clean="false"}}
		&lt;/td&gt;
		&lt;td&gt;
			&lt;table cellpadding="0" cellspacing="0" border="0" style="width:100%"&gt;
				&lt;tr&gt; 
					&lt;td&gt;Host name&lt;/td&gt;
					&lt;td&gt;&lt;input id="txtHostName" style="width:100%" type="text" value="Unknown"/&gt;&lt;/td&gt;
					&lt;td rowspan="5"&gt;CPU usage Pie Graph go here&lt;/td&gt;
					&lt;td rowspan="5"&gt;Memory usage Pie Graph go here&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt; 
					&lt;td&gt;Host IP&lt;/td&gt;
					&lt;td&gt;&lt;input id="txtHostIP" style="width:100%" type="text" value="Unknown"/&gt;&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt; 
					&lt;td&gt;Port&lt;/td&gt;
					&lt;td&gt;&lt;input id="txtPort" type="text" style="width:100%" value="Unknown"/&gt;&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt; 
					&lt;td&gt;Home path&lt;/td&gt;
					&lt;td&gt;&lt;input  id="txtHomePath" style="width:100%" type="text" value="${HOME}/wiperdog"/&gt;&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt; 
					&lt;td&gt;Version&lt;/td&gt;
					&lt;td&gt;&lt;input type="text" style="width:100%" value="1.0"/&gt;&lt;/td&gt;
				&lt;/tr&gt;
                                &lt;tr&gt; 
					&lt;td colspan="4" align="middle"&gt;&lt;input id="btnHostInfo" name="btnHostInfo" style="align: center" type="button" value="Query host info" class="button"/&gt;&lt;/td&gt;
				&lt;/tr&gt;
                                    
			&lt;/table&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td align="center" colspan="3"&gt;&lt;h4&gt;Console log&lt;/h4&gt;&lt;/td&gt;		
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td align="center" colspan="3"&gt;
			&lt;div id="consoleout" style="height:210px;width:100%;"/&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;

{{/html}}
)))

(%id="tabId12"%)((({{box cssClass="tabId12div"}}
Wiperdog system components
{{/box}}
Bundles list
)))</content></xwikidoc>
